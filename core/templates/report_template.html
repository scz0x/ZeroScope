<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ZeroScope Report</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    body { background-color: #0f0f0f; color: #eee; font-family: 'Segoe UI', sans-serif; }
    .badge-sensitive { background-color: #dc3545; }
    .badge-medium { background-color: #ffc107; color: #000; }
    .badge-safe { background-color: #28a745; }
    .section-header { border-bottom: 1px solid #444; padding-bottom: 5px; margin-top: 30px; }
    footer { margin-top: 50px; font-size: 14px; color: #888; }
    .cyber-logo { width: 100px; filter: drop-shadow(0 0 10px #0ff); }
  </style>
</head>
<body>

  <nav class="navbar navbar-dark bg-dark sticky-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">üß™ ZeroScope Report - {{.Version}}</a>
      <div class="d-flex">
        <a class="nav-link text-white" href="#permissions">Permissions</a>
        <a class="nav-link text-white" href="#paths">Sensitive Paths</a>
        <a class="nav-link text-white" href="#apis">APIs</a>
      </div>
    </div>
  </nav>

  <div class="container mt-4" id="report">

    <!-- Permissions -->
    <div id="permissions">
      <h3 class="section-header">üîê Permissions</h3>
      <ul>
        {{range .Permissions}}
          <li>{{.}} {{if (index $.DangerousSet .)}}<span class="badge badge-sensitive">Sensitive</span>{{else}}<span class="badge badge-safe">Safe</span>{{end}}</li>
        {{end}}
      </ul>
    </div>

    <!-- Sensitive Paths -->
    <div id="paths">
      <h3 class="section-header">üß≠ Sensitive Paths</h3>
      {{if .SensitivePaths}}
        <button class="btn btn-outline-light btn-sm mb-2" data-bs-toggle="collapse" data-bs-target="#pathsData">Toggle Details</button>
        <div id="pathsData" class="collapse">
          {{range .SensitivePaths}}<pre>{{.}}</pre>{{end}}
        </div>
      {{else}}
        <p><em>No sensitive paths detected.</em></p>
      {{end}}
    </div>

    <!-- API Calls -->
    <div id="apis">
  <h3 class="section-header">üîå Detected APIs</h3>

  {{if .APICalls.GET}}
    <h5 class="mt-4 text-info">GET</h5>
    <ul>
      {{range .APICalls.GET}}<li><code>{{.}}</code></li>{{end}}
    </ul>
  {{end}}

  {{if .APICalls.POST}}
    <h5 class="mt-4 text-warning">POST</h5>
    <ul>
      {{range .APICalls.POST}}<li><code>{{.}}</code></li>{{end}}
    </ul>
  {{end}}

  {{if .APICalls.PUT}}
    <h5 class="mt-4 text-primary">PUT</h5>
    <ul>
      {{range .APICalls.PUT}}<li><code>{{.}}</code></li>{{end}}
    </ul>
  {{end}}

  {{if .APICalls.DELETE}}
    <h5 class="mt-4 text-danger">DELETE</h5>
    <ul>
      {{range .APICalls.DELETE}}<li><code>{{.}}</code></li>{{end}}
    </ul>
  {{end}}

  {{if .APICalls.OTHER}}
    <h5 class="mt-4 text-secondary">Other Calls</h5>
    <ul>
      {{range .APICalls.OTHER}}<li><code>{{.}}</code></li>{{end}}
    </ul>
  {{end}}
</div>


    <!-- Secrets -->
    <div id="secrets">
      <h3 class="section-header">üß® Secrets Found</h3>
      {{if .SecretsFound}}
        <ul>
          {{range .SecretsFound}}<li><code>{{.}}</code></li>{{end}}
        </ul>
      {{else}}
        <p><em>No secrets detected.</em></p>
      {{end}}
    </div>

    <!-- Suspicious Files -->
    <div id="suspicious">
      <h3 class="section-header">üß± Suspicious Files</h3>
      {{if .Suspicious}}
        <ul>
          {{range .Suspicious}}<li>{{.}}</li>{{end}}
        </ul>
      {{else}}
        <p><em>No suspicious files found.</em></p>
      {{end}}
    </div>

    <!-- Download Button -->
    <div class="text-center mt-5">
      <button class="btn btn-warning" onclick="generatePDF()">üì• Download as PDF</button>
    </div>

    <!-- Footer -->
    <footer class="text-center mt-5">
      <p>Report generated by <strong>ZeroScope</strong> ‚ö°</p>
      <img src="https://raw.githubusercontent.com/scz0x/ZeroScope/main/img/logo.png" alt="logo" class="cyber-logo">
    </footer>
  </div>

  <script>
    function generatePDF() {
      const report = document.getElementById('report');
      html2pdf().from(report).set({
        margin: 0.5,
        filename: 'ZeroScope_Report.pdf',
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
      }).save();
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>